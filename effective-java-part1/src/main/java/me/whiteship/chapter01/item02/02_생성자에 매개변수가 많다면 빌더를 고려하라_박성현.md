# 2. 생성자에 매개변수가 많다면 빌더를 고려하라.
- 정적 팩토리와 생성자에 선택적 매개변수가 많을 때 고려할 수 있는 방안

---


### 점층적 생성자 패턴 또는 생성자 체이닝
- 점층적으로 필드를 추가하면서 생성자 메서드 생성
- 단점으론 값이 어느 파라미터에 들어가는지 알기 어려움
```java
public class NutritionFacts {
    // 필드 ...
    
    // 생성자 체이닝
    public NutritionFacts(int servingSize, int servings) {
        this(servingSize, servings, 0);
    }

    public NutritionFacts(int servingSize, int servings,
                          int calories) {
        this(servingSize, servings, calories, 0);
    }
    
    // ...

    // 어떤 파라미터를 받는 지 명확하지 않음
    public static void main(String[] args) {
      NutritionFacts cocaCola =
              new NutritionFacts(10, 10);
    }
}
```

### 자바빈즈 패턴
- 매개변수가 없는 생성자로 객체를 만든 후,
- setter 메서드를 호출해 원하는 매개변수의 값을 설정하는 방식
- 장점
  - 생성자 체이닝 단점 해결 
  - 객체 생성이 간단해진다.
- 단점
  - 여러 개의 메서드 호출과
  - 객체가 완전히 생성되기 전까지는 일관성이 무너진 상태에 놓인다.
  - 필수 값들이 set 되지 않고 불완전한 상태로 객체를 사용하게 될 수 있다.
  - 일관성이 무너지는 문제로 클래스를 불변으로 만들 수 없다.
```java
public class JavaBeans{
    // ...
    
    public JavaBeans(){
    }

    public void setServingSize(int servingSize){
        this.servingSize=servingSize;
    }

    public void setServings(int servings){
        this.servings=servings;
    }
    
    // ...

    public static void main(String[] args) {
      JavaBeans cocaCola = new JavaBeans();
      cocaCola.setServingSize(240);
      cocaCola.setServings(8);
    
      cocaCola.setCalories(100);
      cocaCola.setSodium(35);
      cocaCola.setCarbohydrate(27);
    }
}
```

---

### 빌더 패턴
- 생성자 체이닝의 안정성과 자바빈즈 패턴의 가독성을 겸비
- 플루언트 API 또는 메서드 체이닝이 가능
- 필드가 많아 생성자의 매개변수가 늘어난다면, 그리고 불변하게 만들고 싶다면 빌더패턴을 고려할 것.
- Lombok의 @Builder를 사용한다면 어노테이션 프로세서를 통해 컴파일 시점에 Builder 코드를 만들어줌
```java
public class BuilderTest {
    // ...
    
    public static class Builder {
        // 필수 매개변수
        private final int servingSize;
        private final int servings;

        // 선택 매개변수 - 기본값으로 초기화한다.
        private int calories = 0;
        private int fat = 0;
        private int sodium = 0;
        private int carbohydrate = 0;

        public Builder(int servingSize, int servings) {
            this.servingSize = servingSize;
            this.servings = servings;
        }

        public Builder calories(int val) {
            calories = val;
            return this;
        }

        public Builder fat(int val) {
            fat = val;
            return this;
        }

        public Builder sodium(int val) {
            sodium = val;
            return this;
        }

        public Builder carbohydrate(int val) {
            carbohydrate = val;
            return this;
        }

        public BuilderTest build() {
            return new BuilderTest(this);
        }
    }
    
    // 플루언트 API 또는 메서드 체이닝
    public static void main(String[] args) {
        BuilderTest cocaCola = new Builder(240, 8)
                .calories(100)
                .sodium(35)
                .carbohydrate(27)
                .build();
    }
}
```
